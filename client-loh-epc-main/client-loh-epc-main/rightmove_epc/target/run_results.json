{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.10", "generated_at": "2024-03-28T08:08:24.270979Z", "invocation_id": "bde75549-7a13-4743-8d9c-926dd9626561", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-28T08:07:10.153211Z", "completed_at": "2024-03-28T08:07:10.195429Z"}, {"name": "execute", "started_at": "2024-03-28T08:07:10.195918Z", "completed_at": "2024-03-28T08:08:24.071705Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 74.11216425895691, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b34927-0103-9c96-0000-71950638e0de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.rightmove_epc.flats_report", "compiled": true, "compiled_code": "with flat_addmatch as (\n\n    select \n    distinct\n    --count(LISTING_ID) as TOTAL_LISTINGS,\n    am.ADDRESSID as RM_ADDRESSID,\n    ADDRESS_1,\n    ADDRESS_2,\n    FULL_POSTCODE,\n    am.UPRN AS RM_UPRN, -- NULL\n    am.LOCAL_AUTHORITY_CODE,\n    GOV_REGION_CODE,\n    FLOOR_AREA,\n    BEDROOM,\n --   am.FLOOR_LEVEL as RM_FLOOR_LEVEL,\n    PROPERTY_TYPE_1,\n    PROPERTY_TYPE_2,\n    COMBINED_PROPERTY_TYPE,\n    epc.UPRN as EPC_UPRN,\n    UPRN_SOURCE,\n    TOTAL_FLOOR_AREA, \n    ADDRESS, \n    ADDRESS1, \n    ADDRESS2, \n    ADDRESS3, \n    POSTCODE, \n    BUILDING_REFERENCE_NUMBER, -- EPC UID\n    epc.ADDRESSID AS EPC_ADDRESSID,\n    -- REMOVE_FROM_RM_MATCH,\n    epc.FLOOR_LEVEL,\n    epc.FLAT_TOP_STOREY,\n    epc.FLAT_STOREY_COUNT,\n    epc.PROPERTY_TYPE\n\n     from ANALYTICS_DEV.dbt_melissa_rm_epc.address_match am\n    inner join ANALYTICS_DEV.dbt_melissa_rm_epc.stg_epc_certs epc on am.EPC_ADDRESSID = epc.ADDRESSID\n    and am.FULL_POSTCODE = epc.POSTCODE\n    where MATCH_EPC = 'YES'\n    and COMBINED_PROPERTY_TYPE in ('HOUSE / FLAT SHARE','FLAT / APARTMENT')\n\n),\n\nflat_uprnmatch as (\n\n    select \n    distinct\n    am.ADDRESSID as RM_ADDRESSID,\n    ADDRESS_1,\n    ADDRESS_2,\n    FULL_POSTCODE,\n    am.UPRN AS RM_UPRN,\n    am.LOCAL_AUTHORITY_CODE,\n    GOV_REGION_CODE,\n    FLOOR_AREA,\n    BEDROOM,\n    PROPERTY_TYPE_1,\n    PROPERTY_TYPE_2,\n    COMBINED_PROPERTY_TYPE,\n    epc.UPRN as EPC_UPRN,\n    UPRN_SOURCE,\n    TOTAL_FLOOR_AREA, \n    ADDRESS, \n    ADDRESS1, \n    ADDRESS2, \n    ADDRESS3, \n    POSTCODE, \n    BUILDING_REFERENCE_NUMBER, \n    epc.ADDRESSID AS EPC_ADDRESSID,\n    epc.FLOOR_LEVEL,\n    epc.FLAT_TOP_STOREY,\n    epc.FLAT_STOREY_COUNT,\n    epc.PROPERTY_TYPE\n\n    \n\n    from ANALYTICS_DEV.dbt_melissa_rm_epc.uprn_match am\n    inner join ANALYTICS_DEV.dbt_melissa_rm_epc.latest_epc_urn epc on am.EPC_UPRN = epc.UPRN\n\n    where MATCH_EPC = 'YES'\n   and COMBINED_PROPERTY_TYPE in ('HOUSE / FLAT SHARE','FLAT / APARTMENT')\n  -- AND RM_UPRN = 100030719363\n\n),\n\nflat_uprnmultimatch as (\n\n    select \n    distinct\n    am.ADDRESSID as RM_ADDRESSID,\n    ADDRESS_1,\n    ADDRESS_2,\n    FULL_POSTCODE,\n    am.UPRN AS RM_UPRN,\n    am.LOCAL_AUTHORITY_CODE,\n    GOV_REGION_CODE,\n    FLOOR_AREA,\n    BEDROOM,\n    PROPERTY_TYPE_1,\n    PROPERTY_TYPE_2,\n    COMBINED_PROPERTY_TYPE,\n    epc.UPRN as EPC_UPRN,\n    UPRN_SOURCE,\n    TOTAL_FLOOR_AREA, \n    ADDRESS, \n    ADDRESS1, \n    ADDRESS2, \n    ADDRESS3, \n    POSTCODE, \n    BUILDING_REFERENCE_NUMBER, \n    epc.ADDRESSID AS EPC_ADDRESSID,\n    epc.FLOOR_LEVEL,\n    epc.FLAT_TOP_STOREY,\n    epc.FLAT_STOREY_COUNT,\n    epc.PROPERTY_TYPE\n\n    \n\n    from ANALYTICS_DEV.dbt_melissa_rm_epc.uprn_match_flat am\n    inner join ANALYTICS_DEV.dbt_melissa_rm_epc.latest_epc_urn epc on am.EPC_UPRN = epc.UPRN\n\n    where MATCH_EPC = 'YES'\n   --and COMBINED_PROPERTY_TYPE not in ('HOUSE / FLAT SHARE','FLAT / APARTMENT') -- this checks to ensure that houses listed on RightMove are included and matched to EPC as flats and removes dupes as this filter has already been applied\n  -- AND RM_UPRN = 100030719363\n\n),\n\nmatches as (\n\n\n\n\nselect * from flat_uprnmatch\n\nunion all\n\nselect * from flat_addmatch\n\nunion all\n\nselect * from flat_uprnmultimatch\n)\n\nselect distinct *  from matches \n/*\n--THIS IS USED FOR A TEST\nselect RM_UPRN,COUNT(BUILDING_REFERENCE_NUMBER)\nfrom house_uprnmatch\nWHERE RM_UPRN IS NOT NULL\nGROUP BY 1\nHAVING COUNT(BUILDING_REFERENCE_NUMBER) >1\n*/", "relation_name": "ANALYTICS_DEV.dbt_melissa_rm_epc.flats_report"}], "elapsed_time": 75.71731519699097, "args": {"log_level": "info", "use_colors_file": true, "log_format_file": "debug", "send_anonymous_usage_stats": true, "exclude": [], "project_dir": "/Users/melissabee/Documents/GitHub/client-loh-floor-area/rightmove_epc", "macro_debugging": false, "vars": {}, "version_check": true, "which": "run", "log_file_max_bytes": 10485760, "select": ["models/reports/flats_report.sql"], "show_resource_report": false, "write_json": true, "favor_state": false, "indirect_selection": "eager", "partial_parse_file_diff": true, "printer_width": 80, "enable_legacy_logger": false, "quiet": false, "warn_error_options": {"include": [], "exclude": []}, "log_path": "/Users/melissabee/Documents/GitHub/client-loh-floor-area/rightmove_epc/logs", "static_parser": true, "strict_mode": false, "invocation_command": "dbt run --select models/reports/flats_report.sql", "defer": false, "use_colors": true, "profiles_dir": "/Users/melissabee/.dbt", "partial_parse": true, "print": true, "introspect": true, "cache_selected_only": false, "log_level_file": "debug", "log_format": "default", "populate_cache": true}}